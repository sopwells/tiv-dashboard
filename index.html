<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tech Investment Valuation (TIV) Dashboard</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: Arial, sans-serif; background-color: #f5f5f5; color: #333; }
        .container { max-width: 1600px; margin: 0 auto; padding: 20px; background-color: white; min-height: 100vh; }
        .header { display: flex; justify-content: center; align-items: center; margin-bottom: 30px; padding-bottom: 20px; border-bottom: 2px solid #eee; }
        .tables-wrapper { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-top: 20px; }
        .table-section:first-child { grid-row: 1 / 3; }
        @media (max-width: 1400px) { .container { max-width: 100%; } .tables-wrapper { grid-template-columns: 1fr 1fr; } }
        @media (max-width: 900px) { .tables-wrapper { grid-template-columns: 1fr; } }
        .table-section { min-width: 0; }
        .dashboard-header { background-color: #4a5bcc; color: white; padding: 15px 20px; font-size: 18px; font-weight: bold; margin-bottom: 0; }
        .table-container { background-color: white; border: 1px solid #ddd; overflow-x: auto; }
        table { width: 100%; border-collapse: collapse; }
        th { background-color: #f8f9fa; padding: 12px 10px; text-align: left; font-weight: bold; border-bottom: 2px solid #dee2e6; font-size: 13px; cursor: pointer; user-select: none; }
        th:hover { background-color: #e9ecef; }
        th::after { content: ' ▲▼'; font-size: 10px; opacity: 0.5; margin-left: 5px; }
        td { padding: 10px; border-bottom: 1px solid #dee2e6; font-size: 13px; }
        tr:hover { background-color: #f8f9fa; }
        .score-badge { display: inline-block; padding: 4px 10px; border-radius: 15px; font-size: 11px; font-weight: bold; text-transform: uppercase; color: white; }
        .technology-leader, .leader, .advanced-leader { background-color: #28a745; }
        .technology-adopter, .adopter, .advanced-adopter { background-color: #007bff; }
        .technology-follower, .follower { background-color: #ffc107; color: #212529; }
        .technology-laggard, .laggard { background-color: #dc3545; }
        .report-link { color: #007bff; text-decoration: none; font-size: 12px; }
        .report-link:hover { text-decoration: underline; }
        .filters { padding: 15px; background-color: #f8f9fa; border-bottom: 1px solid #dee2e6; display: flex; gap: 15px; align-items: center; flex-wrap: wrap; }
        .filter-group { display: flex; align-items: center; gap: 8px; }
        .filter-group label { font-weight: bold; font-size: 13px; }
        .filter-group select, .filter-group input { padding: 6px 10px; border: 1px solid #ced4da; border-radius: 4px; font-size: 13px; }
        .stats { padding: 15px; background-color: #e9ecef; display: flex; justify-content: space-between; align-items: center; font-size: 13px; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo-section">
                <img src="TIV-logo.jpeg" alt="TIV Logo" style="max-height: 200px; width: auto;">
            </div>
        </div>
        
        <div class="tables-wrapper">
            <div class="table-section">
                <div class="dashboard-header">S&P 500 Companies</div>
                <div class="filters">
                    <div class="filter-group">
                        <label>Category:</label>
                        <select id="categoryFilterSP" onchange="filterData('sp500')">
                            <option value="">All Categories</option>
                            <option value="Technology Leader">Technology Leader</option>
                            <option value="Technology Adopter">Technology Adopter</option>
                            <option value="Technology Follower">Technology Follower</option>
                            <option value="Technology Laggard">Technology Laggard</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>Search:</label>
                        <input type="text" id="searchInputSP" placeholder="Company..." onkeyup="filterData('sp500')">
                    </div>
                    <div class="filter-group">
                        <button onclick="clearFilters('sp500')" style="padding: 6px 12px; border: 1px solid #ced4da; background: white; cursor: pointer;">Clear</button>
                    </div>
                </div>
                <div class="stats">
                    <span id="totalCompaniesSP">Total: 0</span>
                    <span id="averageScoreSP">Avg: 0%</span>
                </div>
                <div class="table-container">
                    <table id="tivTableSP">
                        <thead>
                            <tr>
                                <th onclick="sortTable('sp500', 0)">Company</th>
                                <th onclick="sortTable('sp500', 1)">Score</th>
                                <th onclick="sortTable('sp500', 2)">Category</th>
                                <th onclick="sortTable('sp500', 3)">Part 1</th>
                                <th onclick="sortTable('sp500', 4)">Part 2</th>
                                <th onclick="sortTable('sp500', 5)">Part 3</th>
                                <th>Report</th>
                            </tr>
                        </thead>
                        <tbody id="tableBodySP"></tbody>
                    </table>
                </div>
            </div>
            
            <div class="table-section">
                <div class="dashboard-header">Consumer Discretionary</div>
                <div class="filters">
                    <div class="filter-group">
                        <label>Category:</label>
                        <select id="categoryFilterCD" onchange="filterData('cd')">
                            <option value="">All Categories</option>
                            <option value="Leader">Leader</option>
                            <option value="Advanced Adopter">Advanced Adopter</option>
                            <option value="Adopter">Adopter</option>
                            <option value="Follower">Follower</option>
                            <option value="Laggard">Laggard</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>Search:</label>
                        <input type="text" id="searchInputCD" placeholder="Company..." onkeyup="filterData('cd')">
                    </div>
                    <div class="filter-group">
                        <button onclick="clearFilters('cd')" style="padding: 6px 12px; border: 1px solid #ced4da; background: white; cursor: pointer;">Clear</button>
                    </div>
                </div>
                <div class="stats">
                    <span id="totalCompaniesCD">Total: 0</span>
                    <span id="averageScoreCD">Avg: 0%</span>
                </div>
                <div class="table-container">
                    <table id="tivTableCD">
                        <thead>
                            <tr>
                                <th onclick="sortTable('cd', 0)">Company</th>
                                <th onclick="sortTable('cd', 1)">Score</th>
                                <th onclick="sortTable('cd', 2)">Category</th>
                                <th onclick="sortTable('cd', 3)">Part 1</th>
                                <th onclick="sortTable('cd', 4)">Part 2</th>
                                <th onclick="sortTable('cd', 5)">Part 3</th>
                                <th>Report</th>
                            </tr>
                        </thead>
                        <tbody id="tableBodyCD"></tbody>
                    </table>
                </div>
            </div>
            
            <div class="table-section">
                <div class="dashboard-header">Health and Wellbeing</div>
                <div class="filters">
                    <div class="filter-group">
                        <label>Category:</label>
                        <select id="categoryFilterHW" onchange="filterData('hw')">
                            <option value="">All Categories</option>
                            <option value="Follower">Follower</option>
                            <option value="Laggard">Laggard</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>Search:</label>
                        <input type="text" id="searchInputHW" placeholder="Company..." onkeyup="filterData('hw')">
                    </div>
                    <div class="filter-group">
                        <button onclick="clearFilters('hw')" style="padding: 6px 12px; border: 1px solid #ced4da; background: white; cursor: pointer;">Clear</button>
                    </div>
                </div>
                <div class="stats">
                    <span id="totalCompaniesHW">Total: 0</span>
                    <span id="averageScoreHW">Avg: 0%</span>
                </div>
                <div class="table-container">
                    <table id="tivTableHW">
                        <thead>
                            <tr>
                                <th onclick="sortTable('hw', 0)">Company</th>
                                <th onclick="sortTable('hw', 1)">Score</th>
                                <th onclick="sortTable('hw', 2)">Category</th>
                                <th onclick="sortTable('hw', 3)">Part 1</th>
                                <th onclick="sortTable('hw', 4)">Part 2</th>
                                <th onclick="sortTable('hw', 5)">Part 3</th>
                                <th>Report</th>
                            </tr>
                        </thead>
                        <tbody id="tableBodyHW"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script>
        const healthWellbeingData = [
            {company: "Hims & Hers Health", totalScore: 205, percentage: 45.6, category: "Follower", businessScore: 53.3, applicationsScore: 46.7, infrastructureScore: 36.7, reportUrl: "reports/Hims_&_Hers_Health_TIV_Report_Oct_2025.pdf"},
            {company: "Ro", totalScore: 165, percentage: 36.7, category: "Laggard", businessScore: 43.3, applicationsScore: 40.0, infrastructureScore: 26.7, reportUrl: "reports/Ro_TIV_Report_Oct_2025.pdf"},
            {company: "Noom", totalScore: 130, percentage: 28.9, category: "Laggard", businessScore: 46.7, applicationsScore: 26.7, infrastructureScore: 13.3, reportUrl: "reports/Noom_TIV_Report_Oct_2025.pdf"},
            {company: "Cerebral", totalScore: 55, percentage: 12.2, category: "Laggard", businessScore: 10.0, applicationsScore: 26.7, infrastructureScore: 6.7, reportUrl: "reports/Cerebral_TIV_Report_Oct_2025.pdf"}
        ];

        const sp500Data = [{company: "Microsoft", totalScore: 435, percentage: 96.67, category: "Technology Leader", businessScore: 96.67, applicationsScore: 96.67, infrastructureScore: 96.67, reportUrl: "reports/TIV_Report_NEW_Microsoft_20250921.pdf"}, {company: "Meta", totalScore: 420, percentage: 93.33, category: "Technology Leader", businessScore: 86.67, applicationsScore: 96.67, infrastructureScore: 96.67, reportUrl: "reports/TIV_Report_NEW_Meta_20250921.pdf"}, {company: "Amazon", totalScore: 417, percentage: 92.67, category: "Technology Leader", businessScore: 90.0, applicationsScore: 92.67, infrastructureScore: 95.33, reportUrl: "reports/TIV_Report_NEW_Amazon_20250921.pdf"}, {company: "Apple", totalScore: 418, percentage: 92.0, category: "Technology Leader", businessScore: 87.0, applicationsScore: 95.0, infrastructureScore: 97.0, reportUrl: "reports/TIV_Report_NEW_Apple_20250921.pdf"}, {company: "NVIDIA", totalScore: 409, percentage: 91.78, category: "Technology Leader", businessScore: 86.67, applicationsScore: 89.33, infrastructureScore: 96.67, reportUrl: "reports/TIV_Report_NEW_NVIDIA_20250921.pdf"}, {company: "Mastercard", totalScore: 382, percentage: 84.89, category: "Technology Leader", businessScore: 70.0, applicationsScore: 92.0, infrastructureScore: 92.67, reportUrl: "reports/TIV_Report_NEW_Mastercard_20250921.pdf"}, {company: "UnitedHealth", totalScore: 370, percentage: 82.2, category: "Technology Leader", businessScore: 46.7, applicationsScore: 100.0, infrastructureScore: 100.0, reportUrl: "reports/TIV_Report_NEW_UnitedHealth_20250921.pdf"}, {company: "Alphabet", totalScore: 363, percentage: 80.67, category: "Technology Leader", businessScore: 18.89, applicationsScore: 30.89, infrastructureScore: 30.89, reportUrl: "reports/TIV_Report_NEW_Alphabet_20250921.pdf"}, {company: "Cisco", totalScore: 358, percentage: 79.56, category: "Technology Adopter", businessScore: 15.56, applicationsScore: 30.67, infrastructureScore: 33.33, reportUrl: "reports/TIV_Report_NEW_Cisco_20250922.pdf"}, {company: "JPMorgan Chase", totalScore: 343, percentage: 76.2, category: "Technology Adopter", businessScore: 8.9, applicationsScore: 34.0, infrastructureScore: 33.3, reportUrl: "reports/TIV_Report_NEW_JPMorgan_Chase_20250922.pdf"}, {company: "Verizon", totalScore: 333, percentage: 74.0, category: "Technology Adopter", businessScore: 14.0, applicationsScore: 26.0, infrastructureScore: 33.0, reportUrl: "reports/TIV_Report_NEW_Verizon_20250922.pdf"}, {company: "T-Mobile", totalScore: 323, percentage: 71.56, category: "Technology Adopter", businessScore: 15.56, applicationsScore: 24.0, infrastructureScore: 32.22, reportUrl: "reports/TIV_Report_NEW_TMobile_20250922.pdf"}, {company: "Salesforce", totalScore: 311, percentage: 69.1, category: "Technology Adopter", businessScore: 50.0, applicationsScore: 78.7, infrastructureScore: 78.7, reportUrl: "reports/TIV_Report_NEW_Salesforce_20250922.pdf"}, {company: "Tesla", totalScore: 298, percentage: 66.0, category: "Technology Adopter", businessScore: 53.0, applicationsScore: 69.0, infrastructureScore: 77.0, reportUrl: "reports/TIV_Report_NEW_Tesla_20250921.pdf"}, {company: "Eli Lilly and Company", totalScore: 278, percentage: 61.78, category: "Technology Adopter", businessScore: 10.0, applicationsScore: 55.33, infrastructureScore: 100.0, reportUrl: "reports/TIV_Report_NEW_Eli_Lilly_20250922.pdf"}, {company: "Walmart", totalScore: 248, percentage: 55.11, category: "Technology Follower", businessScore: 26.67, applicationsScore: 68.67, infrastructureScore: 70.0, reportUrl: "reports/TIV_Report_NEW_Walmart_20250921.pdf"}, {company: "Broadcom", totalScore: 223, percentage: 49.56, category: "Technology Follower", businessScore: 13.33, applicationsScore: 68.67, infrastructureScore: 66.67, reportUrl: "reports/TIV_Report_NEW_Broadcom_20250922.pdf"}, {company: "Bank of America", totalScore: 211, percentage: 46.4, category: "Technology Follower", businessScore: 30.0, applicationsScore: 44.0, infrastructureScore: 66.6, reportUrl: "reports/TIV_Report_NEW_Bank_of_America_20250921.pdf"}, {company: "Visa", totalScore: 193, percentage: 42.89, category: "Technology Follower", businessScore: 20.0, applicationsScore: 55.33, infrastructureScore: 53.33, reportUrl: "reports/TIV_Report_NEW_Visa_20250921.pdf"}, {company: "Pfizer", totalScore: 191, percentage: 42.44, category: "Technology Follower", businessScore: 23.33, applicationsScore: 55.33, infrastructureScore: 48.67, reportUrl: "reports/TIV_Report_NEW_Pfizer_20250921.pdf"}, {company: "AbbVie", totalScore: 184, percentage: 40.89, category: "Technology Follower", businessScore: 4.44, applicationsScore: 17.56, infrastructureScore: 18.89, reportUrl: "reports/TIV_Report_NEW_AbbVie_20250922.pdf"}, {company: "Abbott", totalScore: 171, percentage: 38.0, category: "Technology Laggard", businessScore: 4.0, applicationsScore: 44.0, infrastructureScore: 57.0, reportUrl: "reports/TIV_Report_NEW_Abbott_20250922.pdf"}, {company: "Wells Fargo", totalScore: 172, percentage: 38.2, category: "Technology Laggard", businessScore: 8.9, applicationsScore: 44.0, infrastructureScore: 44.0, reportUrl: "reports/TIV_Report_NEW_Wells_Fargo_20250922.pdf"}, {company: "Merck", totalScore: 166, percentage: 36.78, category: "Technology Laggard", businessScore: 20.0, applicationsScore: 44.0, infrastructureScore: 46.67, reportUrl: "reports/TIV_Report_NEW_Merck_20250922.pdf"}, {company: "Home Depot", totalScore: 163, percentage: 36.2, category: "Technology Laggard", businessScore: 26.7, applicationsScore: 44.0, infrastructureScore: 38.0, reportUrl: "reports/TIV_Report_NEW_Home_Depot_20250921.pdf"}, {company: "Eli Lilly", totalScore: 161, percentage: 35.78, category: "Technology Laggard", businessScore: 4.44, applicationsScore: 14.67, infrastructureScore: 16.67, reportUrl: "reports/TIV_Report_NEW_Eli_Lilly_20250922.pdf"}, {company: "Disney", totalScore: 158, percentage: 35.11, category: "Technology Follower", businessScore: 16.67, applicationsScore: 44.0, infrastructureScore: 44.67, reportUrl: "reports/TIV_Report_NEW_Disney_20250921.pdf"}, {company: "McDonald's", totalScore: 151, percentage: 33.56, category: "Technology Laggard", businessScore: 20.0, applicationsScore: 44.0, infrastructureScore: 36.67, reportUrl: "reports/TIV_Report_NEW_McDonald's_20250922.pdf"}, {company: "Johnson & Johnson", totalScore: 133, percentage: 29.56, category: "Technology Laggard", businessScore: 20.0, applicationsScore: 44.0, infrastructureScore: 24.67, reportUrl: "reports/TIV_Report_NEW_Johnson_&_Johnson_20250921.pdf"}, {company: "Procter & Gamble", totalScore: 133, percentage: 29.56, category: "Technology Laggard", businessScore: 23.33, applicationsScore: 37.33, infrastructureScore: 28.0, reportUrl: "reports/TIV_Report_NEW_Procter_&_Gamble_20250921.pdf"}, {company: "Chevron", totalScore: 131, percentage: 29.11, category: "Technology Laggard", businessScore: 20.0, applicationsScore: 37.33, infrastructureScore: 30.0, reportUrl: "reports/TIV_Report_NEW_Chevron_20250922.pdf"}, {company: "Coca Cola", totalScore: 108, percentage: 24.0, category: "Technology Laggard", businessScore: 17.0, applicationsScore: 37.0, infrastructureScore: 18.0, reportUrl: "reports/TIV_Report_NEW_Coca_Cola_20250921.pdf"}, {company: "Costco", totalScore: 61, percentage: 13.56, category: "Technology Laggard", businessScore: 5.56, applicationsScore: 24.0, infrastructureScore: 0.0, reportUrl: "reports/TIV_Report_NEW_Costco_20250922.pdf"}, {company: "NextEra Energy", totalScore: 50, percentage: 11.1, category: "Technology Laggard", businessScore: 20.0, applicationsScore: 13.3, infrastructureScore: 0.0, reportUrl: "reports/TIV_Report_NEW_NextEra_Energy_20250922.pdf"}, {company: "Berkshire Hathaway", totalScore: 24, percentage: 5.33, category: "Technology Laggard", businessScore: 13.33, applicationsScore: 2.67, infrastructureScore: 0.0, reportUrl: "reports/TIV_Report_NEW_Berkshire_Hathaway_20250921.pdf"}];

        const consumerDiscretionaryData = [{company: "LVMH", totalScore: 400, percentage: 88.9, category: "Leader", businessScore: 86.7, applicationsScore: 93.3, infrastructureScore: 86.7, reportUrl: "reports/LVMH_TIV_Report.pdf"}, {company: "Burberry", totalScore: 360, percentage: 80.0, category: "Advanced Adopter", businessScore: 76.7, applicationsScore: 86.7, infrastructureScore: 76.7, reportUrl: "reports/Burberry_TIV_Report.pdf"}, {company: "Richemont", totalScore: 315, percentage: 70.0, category: "Adopter", businessScore: 66.7, applicationsScore: 76.7, infrastructureScore: 66.7, reportUrl: "reports/Richemont_TIV_Report.pdf"}, {company: "Tapestry", totalScore: 305, percentage: 67.8, category: "Adopter", businessScore: 66.7, applicationsScore: 73.3, infrastructureScore: 63.3, reportUrl: "reports/Tapestry_TIV_Report.pdf"}, {company: "Capri", totalScore: 285, percentage: 63.3, category: "Adopter", businessScore: 63.3, applicationsScore: 66.7, infrastructureScore: 60.0, reportUrl: "reports/Capri TIV Oct 2025.pdf"}, {company: "Marks & Spencer", totalScore: 240, percentage: 53.3, category: "Technology Follower", businessScore: 53.3, applicationsScore: 63.3, infrastructureScore: 43.3, reportUrl: "reports/MS TIV Oct 2025.pdf"}, {company: "Hermès", totalScore: 130, percentage: 28.9, category: "Laggard", businessScore: 40.0, applicationsScore: 26.7, infrastructureScore: 20.0, reportUrl: "reports/Hermes_TIV_Report.pdf"}];

        let filteredSP500 = [...sp500Data];
        let filteredCD = [...consumerDiscretionaryData];
        let filteredHW = [...healthWellbeingData];
        let sortDirectionSP = {}, sortDirectionCD = {}, sortDirectionHW = {};

        function populateTable(t) {
            const data = t === 'sp500' ? filteredSP500 : t === 'cd' ? filteredCD : filteredHW;
            const tbody = document.getElementById(t === 'sp500' ? 'tableBodySP' : t === 'cd' ? 'tableBodyCD' : 'tableBodyHW');
            tbody.innerHTML = '';
            data.forEach(c => {
                const row = document.createElement('tr');
                row.innerHTML = `<td><strong>${c.company}</strong></td><td><strong>${c.percentage}%</strong></td><td><span class="score-badge ${c.category.toLowerCase().replace(/ /g, '-')}">${c.category}</span></td><td>${c.businessScore}%</td><td>${c.applicationsScore}%</td><td>${c.infrastructureScore}%</td><td><a href="${c.reportUrl}" class="report-link" target="_blank">PDF</a></td>`;
                tbody.appendChild(row);
            });
            updateStats(t);
        }

        function updateStats(t) {
            const data = t === 'sp500' ? filteredSP500 : t === 'cd' ? filteredCD : filteredHW;
            const avg = (data.reduce((s, c) => s + c.percentage, 0) / data.length).toFixed(1);
            const sfx = t === 'sp500' ? 'SP' : t === 'cd' ? 'CD' : 'HW';
            document.getElementById(`totalCompanies${sfx}`).textContent = `Total: ${data.length}`;
            document.getElementById(`averageScore${sfx}`).textContent = `Avg: ${avg}%`;
        }

        function sortTable(t, i) {
            const sd = t === 'sp500' ? sortDirectionSP : t === 'cd' ? sortDirectionCD : sortDirectionHW;
            const col = ['company', 'percentage', 'category', 'businessScore', 'applicationsScore', 'infrastructureScore'][i];
            const num = ['percentage', 'businessScore', 'applicationsScore', 'infrastructureScore'].includes(col);
            const dir = sd[col] === 'asc' ? 'desc' : 'asc';
            sd[col] = dir;
            const data = t === 'sp500' ? filteredSP500 : t === 'cd' ? filteredCD : filteredHW;
            data.sort((a, b) => {
                let vA = a[col], vB = b[col];
                if (num) { vA = Number(vA); vB = Number(vB); } else { vA = vA.toLowerCase(); vB = vB.toLowerCase(); }
                return dir === 'asc' ? (vA < vB ? -1 : vA > vB ? 1 : 0) : (vA > vB ? -1 : vA < vB ? 1 : 0);
            });
            populateTable(t);
        }

        function filterData(t) {
            const sfx = t === 'sp500' ? 'SP' : t === 'cd' ? 'CD' : 'HW';
            const cat = document.getElementById(`categoryFilter${sfx}`).value;
            const search = document.getElementById(`searchInput${sfx}`).value.toLowerCase();
            const src = t === 'sp500' ? sp500Data : t === 'cd' ? consumerDiscretionaryData : healthWellbeingData;
            const filtered = src.filter(c => (!cat || c.category === cat) && (!search || c.company.toLowerCase().includes(search)));
            if (t === 'sp500') filteredSP500 = filtered;
            else if (t === 'cd') filteredCD = filtered;
            else filteredHW = filtered;
            populateTable(t);
        }

        function clearFilters(t) {
            const sfx = t === 'sp500' ? 'SP' : t === 'cd' ? 'CD' : 'HW';
            document.getElementById(`categoryFilter${sfx}`).value = '';
            document.getElementById(`searchInput${sfx}`).value = '';
            if (t === 'sp500') filteredSP500 = [...sp500Data];
            else if (t === 'cd') filteredCD = [...consumerDiscretionaryData];
            else filteredHW = [...healthWellbeingData];
            populateTable(t);
        }

        document.addEventListener('DOMContentLoaded', () => {
            populateTable('hw');
            populateTable('sp500');
            populateTable('cd');
        });
    </script>
</body>
</html>
